# clover_announcement_bot プロジェクト ドキュメント整備指針

> **ドキュメンテーションでわからないことがあれば、まずこのファイルを確認してください。**
>
> **アーカイブ運用・承認フローは `docs/standards/documentation_operations.md` に定義されたルールに必ず従ってください。違反はレビューでブロックされます。**

## 概要

本指針は、clover_announcement_botプロジェクトにおけるドキュメント作成・管理・メンテナンスの統一的な方針を定めるものです。運用プロセスや自動化の詳細は `docs/standards/documentation_operations.md` を参照し、本書では日々の執筆・レビューの実務指針にフォーカスします。

## 関連ドキュメント
- `docs/standards/documentation_operations.md`: draft/plan を中心とした運用ルールと自動化ロードマップ
- `docs/plan/docs/documentation-operations-policy/plan.md`: ドキュメント運用刷新の計画書

## ドキュメントの目的

1. **新メンバー・対象領域外の人が仕様・用法を理解するため**（主目的）
2. **実装上の意図を明確にするため**
3. **汎用的な参考資料として**

## ディレクトリ構造と役割

```
docs/
├── guide/(対象)/          # 使用方法・運用指針・ベストプラクティス・トラブルシューティング
├── reference/(対象)/      # API仕様・詳細リファレンス・簡易的内部実装説明
├── plan/(対象)/          # 実装計画・仕様書（実装完了後も保持）
├── intent/(対象)/        # 実装意図・背景・判断理由（ADR的な用途）
├── survey/(対象)/         # 機能調査・技術比較・検証レポート
├── draft/(対象)/           # メモ・草案置き場（正式化前の作業用）
├── standards/              # 開発ガイドライン・プロジェクト標準（本ファイル含む）
├── archives/               # intent 承認後に移送する保管庫
```

### `docs/guide/(機能名)/` - 使用方法ガイド

- **目的**: 実際の開発シナリオでの使い方を学ぶ
- **読者**: 新メンバー・対象領域外の人（仕様・用法理解が目的）
- **内容**: 
  - 基本的な使用方法・操作手順
  - 運用・開発上の指針
  - チュートリアル
  - プロジェクト固有のベストプラクティス
  - トラブルシューティング
- **相互参照**: reference への根拠提示として積極的に参照
  - 例：「詳細な仕様は `reference/logging-api.md` を参照」

### `docs/reference/(対象)/` - API仕様リファレンス

- **目的**: 特定のAPI仕様を確認する辞書的用途
- **読者**: 実装時に詳細な仕様を調べたい開発者
- **内容**:
  - クラス・メソッド単位の詳細説明
  - パラメータ・戻り値・例外の完全仕様
  - 簡易的な内部実装説明
- **ステータス**: 実装済み機能のみ記載（開発中は🚧マーク + 実装時期明記）
- **相互参照**: guide への実践例誘導として積極的に参照
  - 例：「実際の使用例は `guide/logging.md` のベストプラクティスを参照」

### `docs/plan/(対象)/` - 実装計画・仕様書

- **目的**: 実装計画・技術仕様書の保管庫
- **読者**: 実装背景を理解したい開発者・新メンバー
- **内容**: 詳細仕様、実装計画概要、技術検討資料
- **ライフサイクル**: 実装完了後も削除せず、intent の原典として活用
- **特徴**: 計画段階・開発中・実装済み全ての機能を含む

### `docs/intent/(対象)/` - 実装意図・設計判断

- **目的**: 実装上の意図・背景・判断理由の記録（ADR的用途）
- **読者**: 設計判断の背景を理解したい開発者
- **内容**: なぜその設計にしたか、検討した代替案、トレードオフ等
- **特徴**: 現状の事実（reference）と実装意図を分離管理
- **記録対象**: アーキテクチャ決定、技術選択、設計方針変更等

### `docs/survey/(対象)/` - 調査レポート・検証結果

- **目的**: 調査・検証・比較検討の結果を体系的に蓄積し、意思決定や後続作業の根拠を共有する
- **読者**: 調査結果を踏まえて計画・実装を行う開発者、意思決定者
- **内容**:
  - 実装前の技術調査、性能計測レポート
  - 競合機能比較やUI/UXリサーチのまとめ
  - 検証手順・条件・結論の詳細記録
- **運用**:
  - 調査完了後に速報ベースのメモ（draft）から整理して移管
  - フォーマットは基本的に「背景 → 目的 → 手法 → 結果 → 考察 → 推奨アクション」を推奨
  - 計画ドキュメント（plan）や意図ドキュメント（intent）から参照し、根拠資料として活用

> **補足**: 一時的・未整理のメモは引き続き `docs/draft/` に置き、調査が完了したら `docs/survey/` へ昇格させる。

### `docs/draft/(対象)/` - メモ・草案置き場

- **目的**: メモ・草案の統一管理（正式ドキュメント化前の作業用）
- **読者**: 開発者・ドキュメント作成者
- **内容**: 
  - コミット時に残す実装意図メモ
  - 正式化前の草案
  - 作業中の一時的な資料
- **運用**: メモと草案を区別せず統一的に管理
- **ライフサイクル**: 正式ドキュメント化後は移動・削除

> **ドキュメント昇格フロー**: draft → survey（調査完了時） → plan → intent → guide/reference（詳細は `docs/standards/documentation_operations.md` を参照）

#### draft の TTL と保守
- 各 draft には front-matter で `ttl_days`（既定30日）を設定し、期限と担当者（`next_action_by`）を明示する。
- 期限超過時は stale Bot の Issue 発行に従い、昇格/クローズ/延長の判断を3営業日以内にコメントする。

### `docs/standards/` - 開発ガイドライン・標準

- **目的**: プロジェクト全体の開発ガイドライン・標準の管理
- **読者**: 全プロジェクトメンバー
- **内容**: 本指針、コーディング規約、その他プロジェクト標準
- **特徴**: プロジェクト横断的なルール・方針を集約

## Front-matter の必須要素

全ての正式ドキュメント（draft含む）には front-matter を付与し、以下の必須キーを管理する。追加のフィールドや詳細スキーマは `documentation_operations.md` を参照。

| 区分 | 必須キー |
| --- | --- |
| 共通 | `title`, `domain`, `status`, `version`, `created`, `updated`, `related_issues`, `related_prs`, `references` |
| draft 専用 | `state`, `hypothesis`, `options`, `open_questions`, `next_action_by`, `review_due`, `ttl_days` |
| plan 専用 | `scope`, `non_goals`, `requirements`, `constraints`, `api_changes`, `data_models`, `migrations`, `rollout_plan`, `rollback`, `test_plan`, `observability`, `security_privacy`, `performance_budget`, `i18n_a11y`, `acceptance_criteria`, `owners` |

## 対象読者

- **主要読者**: 新メンバー・対象領域の実装に関わっていない人
- **技術レベル**: Flutter/Dart中級者～上級者を前提
- **学習目的ではなく「ドキュメント」としての品質を優先**
- **特記事項**: AIエージェントも読者として想定

## 言語・記法ルール

### 言語使用方針

- **API名・クラス名・メソッド名**: 英語のまま記載
- **説明文・本文**: 日本語で記述
- **固有名詞**: 原語で記載（Flutter, Dart, Riverpod等）
- **技術用語**: 一般的な基準で記述（明文化しない）

### 専門用語・略語

- **初出時**: 正式名称+略語併記（例：「NDJSON（Newline Delimited JSON）」）
- **2回目以降**: 略語のみ使用可
- **プロジェクト固有用語集**: 作成しない

### Markdown記法

- **見出しレベル**: 
  - `#`: 文書タイトル
  - `##`: 大セクション
  - `###`: 中セクション
  - `####以下`: 小セクション
- **コードブロック**: 言語指定を推奨（必須ではない）
- **表・リスト・引用**: 特定スタイルの指定なし

### コード記載ルール

- **コード引用**: 現状をそのまま保持
- **コード例**:
  - 変数名: 英語
  - コメント: 日本語
- **API名**: 英語のまま、説明は日本語

## 実装ステータスの扱い

### ステータス表記方針

- **reference/**: 実装済み機能のみ記載を原則
- **開発中機能**: 🚧マーク + 実装時期明記で記載可
- **未実装機能**: 記載しない（plan/ に記述）
- **バージョン情報**: 不要
- **実装時期**: 明記する

### ドキュメント種別別の扱い

| ドキュメント種別 | 実装済み | 開発中 | 未実装・計画中 |
|------------------|----------|--------|----------------|
| guide/           | ✅記載   | 🚧マーク付きで記載 | ❌記載しない |
| reference/       | ✅記載   | 🚧マーク付きで記載 | ❌記載しない |
| plan/            | ✅記載   | ✅記載   | ✅記載 |
| intent/          | ✅記載   | ✅記載   | ✅記載 |

## メンテナンス方針

### 更新フロー

1. **コミット時**: 実装意図・変更内容のメモを `docs/draft/(対象)/` に記録
2. **定期的**: メモを基に正式ドキュメントへ昇華
3. **レビュー**: 正式ドキュメント完成時、関与領域更新時、定期的（2~3ヶ月）

### 責任分担

- **メモ作成**: コードを変更した人
- **正式ドキュメント化**: 専任担当者またはAIエージェント
- **レビュー**: プロジェクトメンバー

### 更新タイミング

- **優先度**: 明確に設けないが、暗黙的に「新機能 > リファクタリング」順になる可能性（排除しない）
- **時間経過**: 実装時の意図や目的がブレやすいため、コミット時のメモ作成を重視

### 整合性チェック & 自動化

- **手法**: lint（markdownlint-cli2） / link-check（lychee） / front-matter 検証を段階的に導入予定。詳細は `documentation_operations.md` のロードマップを参照。
- **現状**: 自動化フェーズの移行中。CI 未導入の項目はレビュー時に手動確認する。
- **対応ルール**:
  1. **発見時対応**: 問題を見つけた人が修正または Issue 作成。Issue 番号は該当ドキュメントの `related_issues` に追記。
  2. **優先度**: 実害のある不整合 > 表記の不統一 > 軽微な古い情報。
  3. **修正範囲**: 関連する `guide/` や `reference/` を同時に確認し、必要なら plan / intent も更新する。

### 品質保証

- **レビュータイミング**:
  - 正式ドキュメント完成時
  - 関与領域更新時（簡易レビュー）
  - stale Bot からの通知（draft TTL 超過）
  - 定期棚卸し（Docs Platform WG が四半期ごとに実施）
- **古い情報の検出**: lint / link-check / stale Bot と手動レビューを併用。
- **将来的検討**: Front-matter 検証を CI に導入後、LLM レビューの PoC を検討。

### Bot・CI 運用

- stale draft Bot が `ttl_days` を監視し、期限超過で Issue を自動生成。受領者は 3 営業日以内に「昇格・クローズ・延長」の方針をコメントする。
- markdownlint / lychee / front-matter チェックの結果は PR で確認し、失敗時は作成者が一次対応。継続した不具合は Docs Platform WG にエスカレーション。
- CI の実行時間は合計 5 分以内を上限とし、超過する場合はドキュメント標準のパフォーマンス予算に従い調整する。

## 重複・相互参照方針

### 重複について
- **基本方針**: 各ドキュメントの目的達成のために必要であれば重複を許容
- **制約**: 目的に特化しすぎず、ある程度汎用的に仕上げる

### 相互参照
- **guide → reference**: ガイドの根拠として参照
  - 例：「`reference/logging-api.md` の LogLevel 仕様に基づいて...」
- **reference → guide**: 補足説明や実践的使用方法の誘導
  - 例：「実際の使用例は `guide/logging.md` を参照」
  - 例：「`guide/logging.md` に実例とチュートリアルが記載されています」
- **同一ディレクトリ内**: 必要に迫られた場合のみ（基本的には想定しない）

## 新機能のドキュメント作成手順

1. **実装開始時**: `docs/draft/(機能名)/` にメモ・草案を作成
2. **調査フェーズ**: 重要な調査・検証結果を `docs/survey/(機能名)/` に整理して保存
3. **実装中**: 重要な設計判断を `docs/draft/(機能名)/intent_notes.md` に記録
4. **実装完了後**: 
   - `docs/guide/(機能名)/` に使用方法ガイド作成
   - `docs/reference/(機能名)/` にAPI仕様リファレンス作成
   - `docs/intent/(機能名)/` に設計意図ドキュメント作成
5. **レビュー**: 各ドキュメントをレビューし正式化
6. **クリーンアップ**: `docs/draft/(機能名)/` を整理・移動・削除し、必要に応じて survey ドキュメントを更新。期限延長が必要な場合は `ttl_days` を更新し、理由を関連 Issue にコメントする。

## よくある質問

### Q: どのディレクトリに書けばよいか分からない場合は？
A: まず `docs/draft/` に書き始めてください。内容が固まってから適切な場所に移動します。

### Q: 既存ドキュメントとの整合性が心配な場合は？
A: 関連する guide/ と reference/ を同時に確認し、必要に応じて両方を更新してください。

### Q: 実装途中の機能をドキュメント化すべきか？
A: reference/ では🚧マークを付けて記載可能ですが、未実装部分は plan/ に記述してください。

## 適用開始

本指針は策定完了後、即座に適用開始とし、既存ドキュメントも段階的に本方針に準拠するよう更新していく。

---

*本指針は 2025年8月 に策定され、2025年10月に `documentation_operations` 標準と整合化されました。*
